name: CMake Library Build
on: [push, workflow_dispatch]

jobs:
    build-lib:
        name: ${{ matrix.os }}-${{ github.workflow }}
        runs-on: ${{ matrix.os }}
        strategy:
            matrix:
                os: [ubuntu-latest, windows-latest]

        steps:
            - uses: actions/checkout@v3

            - name: Create Build Environment
              run: cmake -E make_directory ${{runner.workspace}}/build

            - uses: lukka/get-cmake@latest
            - name: dir
              run: find $RUNNER_WORKSPACE
              shell: bash

            - name: Generate project files using CMake
              shell: bash
              run: cmake -B ${{runner.workspace}}/build

            - name: Build library (Release configuration)
              working-directory: ${{runner.workspace}}/build
              shell: bash
              run: cmake --build . --config Release

            - name: List $RUNNER_WORKSPACE after build
              run: find $RUNNER_WORKSPACE
              shell: bash